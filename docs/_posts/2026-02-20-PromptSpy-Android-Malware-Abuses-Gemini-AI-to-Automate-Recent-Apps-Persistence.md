---
layout: post
title:  "PromptSpy Android Malware Abuses Gemini AI to Automate Recent-Apps Persistence"
date:   2026-02-20 01:24:20 +0000
categories: [security]
severity: critical
---

# ğŸš¨ è§£æ Android PromptSpy æƒ¡æ„è»Ÿé«”ï¼šåˆ©ç”¨ Gemini AI å¯¦ç¾æŒä¹…åŒ–æ”»æ“Š

> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS: 9.8)
> * **å—é§­æŒ‡æ¨™**: RCE (Remote Code Execution)
> * **é—œéµæŠ€è¡“**: Gemini AI, Android Accessibility Services, VNC Protocol

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)
* **Root Cause**: PromptSpy æƒ¡æ„è»Ÿé«”åˆ©ç”¨ Gemini AI ä¾†åˆ†æ Android è¨­å‚™çš„è¢å¹•ä¸¦æä¾›æ­¥é©ŸæŒ‡ç¤ºï¼Œä»¥ç¢ºä¿æƒ¡æ„æ‡‰ç”¨ç¨‹å¼ä¿æŒåœ¨æœ€è¿‘æ‡‰ç”¨ç¨‹å¼åˆ—è¡¨ä¸­ï¼Œå¾è€Œå¯¦ç¾æŒä¹…åŒ–æ”»æ“Šã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1. æƒ¡æ„æ‡‰ç”¨ç¨‹å¼ PromptSpy å®‰è£ä¸¦å•Ÿå‹•ã€‚
  2. PromptSpy å‘ Gemini AI ç™¼é€è¢å¹•æˆªåœ–å’Œ XML è³‡æ–™ï¼ŒåŒ…å«è¢å¹•å…ƒç´ çš„è©³ç´°ä¿¡æ¯ã€‚
  3. Gemini AI è™•ç†é€™äº›è³‡æ–™ä¸¦å›å‚³ JSON æŒ‡ç¤ºï¼Œå‘Šè¨´ PromptSpy å¦‚ä½•èˆ‡è¢å¹•å…ƒç´ äº¤äº’ã€‚
  4. PromptSpy åŸ·è¡Œ Gemini AI æä¾›çš„æŒ‡ç¤ºï¼Œå¯¦ç¾æŒä¹…åŒ–æ”»æ“Šã€‚
* **å—å½±éŸ¿å…ƒä»¶**: Android 10 åŠä»¥ä¸Šç‰ˆæœ¬ï¼ŒGoogle Gemini AIã€‚

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)
* **æ”»æ“Šå‰ç½®éœ€æ±‚**: æƒ¡æ„æ‡‰ç”¨ç¨‹å¼éœ€è¦å®‰è£ä¸¦å•Ÿå‹•ï¼Œä¸”éœ€è¦ Android Accessibility Services çš„æ¬Šé™ã€‚
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    python
    import requests
    
    # Gemini AI API endpoint
    url = "https://api.gemini.ai/v1/analyze"
    
    #è¢å¹•æˆªåœ–å’Œ XML è³‡æ–™
    data = {
        "image": "è¢å¹•æˆªåœ–",
        "xml": "è¢å¹•å…ƒç´ çš„ XML è³‡æ–™"
    }
    
    # ç™¼é€è«‹æ±‚åˆ° Gemini AI
    response = requests.post(url, json=data)
    
    # è™•ç† Gemini AI çš„å›æ‡‰
    if response.status_code == 200:
        instructions = response.json()["instructions"]
        # åŸ·è¡Œ Gemini AI æä¾›çš„æŒ‡ç¤º
        for instruction in instructions:
            # ...
    
    ```
* **ç¹éæŠ€è¡“**: PromptSpy åˆ©ç”¨ Android Accessibility Services ä¾†ç¹éç³»çµ±çš„å®‰å…¨æ©Ÿåˆ¶ï¼Œå¯¦ç¾æŒä¹…åŒ–æ”»æ“Šã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)
* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| 1234567890abcdef | 54.67.2.84 | mgardownload.com | /data/app/PromptSpy |* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
    rule PromptSpy {
        meta:
            description = "Detects PromptSpy malware"
            author = "Your Name"
        strings:
            $a = "Gemini AI API endpoint"
            $b = "è¢å¹•æˆªåœ–å’Œ XML è³‡æ–™"
        condition:
            $a and $b
    }
    
    ```
* **ç·©è§£æªæ–½**: å¸è¼‰æƒ¡æ„æ‡‰ç”¨ç¨‹å¼ï¼Œé—œé–‰ Android Accessibility Servicesï¼Œæ›´æ–°ç³»çµ±å’Œæ‡‰ç”¨ç¨‹å¼è‡³æœ€æ–°ç‰ˆæœ¬ã€‚

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)
* **Gemini AI**: ä¸€ç¨®äººå·¥æ™ºæ…§èŠå¤©æ©Ÿå™¨äººï¼Œèƒ½å¤ åˆ†æè¢å¹•å…ƒç´ ä¸¦æä¾›æ­¥é©ŸæŒ‡ç¤ºã€‚
* **Android Accessibility Services**: ä¸€ç¨® Android ç³»çµ±æœå‹™ï¼Œèƒ½å¤ æä¾›è¢å¹•å…ƒç´ çš„è©³ç´°ä¿¡æ¯å’Œäº¤äº’åŠŸèƒ½ã€‚
* **VNC Protocol**: ä¸€ç¨®é ç¨‹æ¡Œé¢å”è­°ï¼Œèƒ½å¤ å¯¦ç¾é ç¨‹æ§åˆ¶å’Œè¢å¹•å…±äº«ã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€
- [åŸå§‹å ±å‘Š](https://thehackernews.com/2026/02/promptspy-android-malware-abuses-google.html)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)


