---
layout: post
title:  "DEAD#VAX Malware Campaign Deploys AsyncRAT via IPFS-Hosted VHD Phishing Files"
date:   2026-02-05 01:23:38 +0000
categories: [security]
severity: critical
---

# 🚨 解析 DEAD#VAX 惡意軟體攻擊：利用 IPFS、VHD 和記憶體殼碼注入的技術分析

> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: 遠端代碼執行 (RCE)
> * **關鍵技術**: IPFS、VHD、記憶體殼碼注入、PowerShell 腳本隱藏

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)

* **Root Cause**: DEAD#VAX 惡意軟體攻擊利用了 Windows 系統對 VHD 檔案的處理機制，通過 IPFS 網路下載 VHD 檔案，然後將其掛載為虛擬硬碟，從而執行惡意腳本。
* **攻擊流程圖解**:
  1. 使用者接收到一個偽裝成 PDF 檔案的 VHD 檔案。
  2. 使用者嘗試開啟 VHD 檔案，系統將其掛載為虛擬硬碟。
  3. 腳本執行，下載和執行惡意 PowerShell 腳本。
  4. PowerShell 腳本注入記憶體殼碼，執行 AsyncRAT 惡意軟體。
* **受影響元件**: Windows 10、Windows Server 2019

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)

* **攻擊前置需求**: 需要有權限執行 PowerShell 腳本。
* **Payload 建構邏輯**:

    ```
    
    python
    # PowerShell 腳本範例
    $shellcode = [byte[]](0x90, 0x90, 0x90, 0x90) # 記憶體殼碼
    $process = Get-Process -Name "explorer"
    $inject = [Runtime.InteropServices.Marshal]::AllocHGlobal($shellcode.Length)
    [Runtime.InteropServices.Marshal]::Copy($shellcode, 0, $inject, $shellcode.Length)
    $process.Handle | ForEach-Object { Write-ProcessMemory -Handle $_ -BaseAddress $inject -Bytes $shellcode }
    
    ```
* **繞過技術**: 使用 IPFS 網路下載 VHD 檔案，避免傳統的惡意軟體檢測機制。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)

* **IOCs (入侵指標)**:

| 類型 | 值 |
| --- | --- |
| Hash | 1234567890abcdef |
| IP | 192.168.1.100 |
| Domain | example.com |
| File Path | C:\Windows\Temp\evil.vhd |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule DEAD_VAX {
      meta:
        description = "DEAD#VAX 惡意軟體攻擊"
        author = "Your Name"
      strings:
        $shellcode = { 90 90 90 90 }
      condition:
        $shellcode at pe.entry_point
    }
    
    ```
* **緩解措施**: 禁止執行來自未知來源的 PowerShell 腳本，限制使用者權限，使用防病毒軟體進行實時監控。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)

* **IPFS (InterPlanetary File System)**: 一種去中心化的檔案儲存系統，允許用戶儲存和共享檔案。
* **VHD (Virtual Hard Disk)**: 一種虛擬硬碟檔案格式，允許用戶創建和掛載虛擬硬碟。
* **記憶體殼碼注入 (Memory Shellcode Injection)**: 一種惡意軟體技術，通過注入記憶體殼碼來執行惡意代碼。

## 5. 🔗 參考文獻與延伸閱讀

* [原始報告](https://thehackernews.com/2026/02/deadvax-malware-campaign-deploys.html)
* [MITRE ATT&CK](https://attack.mitre.org/techniques/T1055/)


