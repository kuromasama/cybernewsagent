---
layout: post
title:  "From BRICKSTORM to GRIMBOLT: UNC6201 Exploiting a Dell RecoverPoint for Virtual Machines Zero-Day"
date:   2026-02-18 01:29:59 +0000
categories: [security]
severity: critical
---

# ğŸš¨ è§£æ UNC6201 å° Dell RecoverPoint çš„é›¶æ—¥æ”»æ“Šï¼šGRIMBOLT èƒŒé–€çš„æŠ€è¡“ç´°ç¯€
> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS åˆ†æ•¸ï¼š10.0)
> * **å—é§­æŒ‡æ¨™**: é ç«¯å‘½ä»¤åŸ·è¡Œ (RCE)
> * **é—œéµæŠ€è¡“**: Native AOT ç·¨è­¯ã€UPX å£“ç¸®ã€iptables Single Packet Authorization

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)
* **Root Cause**: Dell RecoverPoint for Virtual Machines ä¸­çš„ Apache Tomcat Manager å­˜åœ¨ç¡¬ç·¨ç¢¼çš„ admin ç”¨æˆ¶å¯†ç¢¼ï¼Œå…è¨±æ”»æ“Šè€…ä½¿ç”¨ `/manager/text/deploy` ç«¯é»ä¸Šå‚³æƒ¡æ„ WAR æ–‡ä»¶ï¼Œé€²è€ŒåŸ·è¡Œç³»çµ±å‘½ä»¤ã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1.æ”»æ“Šè€…ç™¼é€ HTTP è«‹æ±‚åˆ° `/manager/text/deploy` ç«¯é»ï¼Œä½¿ç”¨ç¡¬ç·¨ç¢¼çš„ admin ç”¨æˆ¶å¯†ç¢¼é€²è¡Œé©—è­‰ã€‚
  2.æ”»æ“Šè€…ä¸Šå‚³æƒ¡æ„ WAR æ–‡ä»¶ï¼ŒåŒ…å« SLAYSTYLE ç¶²é æ®¼ã€‚
  3.æ”»æ“Šè€…åŸ·è¡Œç³»çµ±å‘½ä»¤ï¼Œéƒ¨ç½² GRIMBOLT èƒŒé–€ã€‚
* **å—å½±éŸ¿å…ƒä»¶**: Dell RecoverPoint for Virtual Machines (ç‰ˆæœ¬è™ŸæœªæŒ‡å®š)

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)
* **æ”»æ“Šå‰ç½®éœ€æ±‚**: ç¶²è·¯å­˜å–ã€admin ç”¨æˆ¶å¯†ç¢¼
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    http
    POST /manager/text/deploy HTTP/1.1
    Host: <target_ip>
    Content-Type: application/octet-stream
    
    <WAR_FILE_CONTENTS>
    
    ```
* **ç¹éæŠ€è¡“**: ä½¿ç”¨ iptables Single Packet Authorization æŠ€è¡“ï¼Œå…è¨±æ”»æ“Šè€…åœ¨ä¸éœ€è¦é©—è­‰çš„æƒ…æ³ä¸‹å­˜å–ç³»çµ±ã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)
* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

| é¡å‹ | å€¼ |
| --- | --- |
| Hash | <hash_value> |
| IP | <ip_address> |
| Domain | <domain_name> |
| File Path | /var/lib/tomcat9/ |* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
    rule G_APT_BackdoorToehold_GRIMBOLT_1 {
      meta:
        author = "Google Threat Intelligence Group (GTIG)"
      strings:
        $s1 = { 40 00 00 00 41 18 00 00 00 4B 21 20 C2 2C 08 23 02 }
      condition:
        uint32(0) == 0x464c457f and all of ($s*)
    }
    
    ```
* **ç·©è§£æªæ–½**: æ›´æ–° Dell RecoverPoint for Virtual Machines è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œè®Šæ›´ admin ç”¨æˆ¶å¯†ç¢¼ï¼Œé™åˆ¶ç¶²è·¯å­˜å–ã€‚

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)
* **Native AOT ç·¨è­¯**: ä¸€ç¨®ç·¨è­¯æŠ€è¡“ï¼Œå…è¨± .NET ä»£ç¢¼ç›´æ¥ç·¨è­¯ç‚ºæ©Ÿå™¨ç¢¼ï¼Œæé«˜æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚
* **UPX å£“ç¸®**: ä¸€ç¨®å£“ç¸®æŠ€è¡“ï¼Œå…è¨±æ¸›å°å¯åŸ·è¡Œæ–‡ä»¶çš„å¤§å°ï¼Œæé«˜æ”»æ“Šè€…éš±è”½æ€§ã€‚
* **iptables Single Packet Authorization**: ä¸€ç¨®æŠ€è¡“ï¼Œå…è¨±åœ¨ä¸éœ€è¦é©—è­‰çš„æƒ…æ³ä¸‹å­˜å–ç³»çµ±ï¼Œæé«˜æ”»æ“Šè€…éš±è”½æ€§ã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€
- [åŸå§‹å ±å‘Š](https://cloud.google.com/blog/topics/threat-intelligence/unc6201-exploiting-dell-recoverpoint-zero-day/)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1190/)


