---
layout: post
title:  "A 0-click exploit chain for the Pixel 9 Part 2: Cracking the Sandbox with a Big Wave"
date:   2026-01-17 06:22:12 +0000
categories: [security]
---

# 🚨 解析 Pixel 9 的 BigWave 驅動程式漏洞：從用後釋放到內核任意讀寫

> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: Local Privilege Escalation (LPE) 和任意讀寫
> * **關鍵技術**: Use-After-Free (UAF), Heap Spraying, KASLR 繞過

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: BigWave 驅動程式中的 `bigo_worker_thread` 函數會存取已經釋放的 `inst` 物件，導致 Use-After-Free (UAF) 漏洞。
* **攻擊流程圖解**:
  1. 攻擊者開啟 `/dev/bigwave` 裝置並提交工作到 BigWave 硬體。
  2. `bigo_worker_thread` 函數會處理工作並存取 `inst` 物件。
  3. 攻擊者關閉 `/dev/bigwave` 裝置，導致 `inst` 物件被釋放。
  4. `bigo_worker_thread` 函數仍然存取已經釋放的 `inst` 物件，導致 UAF 漏洞。
* **受影響元件**: Pixel 9 的 BigWave 驅動程式

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 攻擊者需要有 `/dev/bigwave` 裝置的存取權限。
* **Payload 建構邏輯**:

    ```
        
        c
        // 建構 UAF Payload
        struct bigo_inst *inst = kmalloc(sizeof(struct bigo_inst), GFP_KERNEL);
        inst->job.regs = kmalloc(sizeof(struct bigo_regs), GFP_KERNEL);
        // ...
        
        // 提交工作到 BigWave 硬體
        ioctl(fd, BIGO_IOCX_PROCESS, &inst->job);
        
        // 關閉 /dev/bigwave 裝置，導致 inst 物件被釋放
        close(fd);
        
        // UAF Payload 觸發
        bigo_worker_thread();
        
        
    
    ```
* **繞過技術**: KASLR 繞過可以使用 `0xffffff8000010000` 作為基址。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |

| --- | --- | --- | --- |

| ... | ... | ... | ... |
* **偵測規則 (Detection Rules)**:

    ```
        
        yara
        rule BigWave_UAF {
          meta:
            description = "BigWave UAF 漏洞偵測"
            author = "..."
          condition:
            // ...
        }
        
        
    
    ```
* **緩解措施**: 更新 BigWave 驅動程式並修復 UAF 漏洞。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **Use-After-Free (UAF)**: 想像兩個人同時去改同一本帳簿。技術上是指多個執行緒同時存取共享記憶體，且至少有一個是寫入動作，導致數據不一致或邏輯錯誤。
* **KASLR (Kernel Address Space Layout Randomization)**: 一種安全機制，旨在防止攻擊者預測內核記憶體布局。
* **Heap Spraying**: 一種攻擊技術，旨在佔據大量記憶體空間，以增加攻擊成功的機會。

## 5. 🔗 參考文獻與延伸閱讀
* [原始報告](https://projectzero.google/2026/01/pixel-0-click-part-2.html)
* [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)

