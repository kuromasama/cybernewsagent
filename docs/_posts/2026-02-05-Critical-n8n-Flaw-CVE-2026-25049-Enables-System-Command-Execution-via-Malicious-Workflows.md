---
layout: post
title:  "Critical n8n Flaw CVE-2026-25049 Enables System Command Execution via Malicious Workflows"
date:   2026-02-05 06:50:44 +0000
categories: [security]
severity: critical
---

# 🚨 解析 n8n 工作流自動化平台的命令執行漏洞
> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS 分數: 9.4)
> * **受駭指標**: 遠端命令執行 (RCE)
> * **關鍵技術**: TypeScript 的編譯時型別系統、JavaScript 的執行時行為、工作流參數的crafted 表達式

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: n8n 工作流自動化平台的表達式評估機制中，存在一個由於 TypeScript 的編譯時型別系統和 JavaScript 的執行時行為之間的差異而導致的漏洞。這個漏洞使得攻擊者可以繞過安全檢查，執行任意系統命令。
* **攻擊流程圖解**: 
  1. 攻擊者創建一個工作流，包含一個公開可訪問的 webhook。
  2. 攻擊者在工作流參數中添加一條crafted 表達式，使用 JavaScript 的解構語法。
  3. 當 webhook 被觸發時，n8n 平台會執行工作流，包括評估crafted 表達式。
  4. 由於 TypeScript 的編譯時型別系統不能強制執行時的型別檢查，crafted 表達式可以繞過安全檢查，執行任意系統命令。
* **受影響元件**: n8n 工作流自動化平台的版本 <1.123.17 和 <2.5.2。

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 攻擊者需要有創建和修改工作流的權限。
* **Payload 建構邏輯**:

    ```
    
    javascript
    // 範例crafted 表達式
    const payload = `(${require('child_process').exec('ls -l')})`;
    
    ```
    * 攻擊者可以使用這種crafted 表達式來執行任意系統命令。
* **繞過技術**: 攻擊者可以使用crafted 表達式來繞過安全檢查，執行任意系統命令。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**: 

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
|  |  |  |  |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule n8n_rce {
      meta:
        description = "n8n 工作流自動化平台的命令執行漏洞"
        author = "Your Name"
      strings:
        $s1 = "child_process"
        $s2 = "exec"
      condition:
        all of them
    }
    
    ```
    * 這條 YARA 規則可以用來偵測 n8n 工作流自動化平台的命令執行漏洞。
* **緩解措施**: 
  1. 更新 n8n 工作流自動化平台到最新版本。
  2. 限制工作流創建和修改的權限。
  3. 部署 n8n 工作流自動化平台在一個加固的環境中，限制操作系統權限和網路訪問。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **TypeScript**: 一種由 Microsoft 開發的編程語言，為 JavaScript 的超集。TypeScript 的主要目的是為了提供更好的編譯時型別檢查和錯誤報告。
* **JavaScript 的執行時行為**: JavaScript 的執行時行為是指 JavaScript 代碼在執行時的行為，包括變數的作用域、函數的調用、對象的創建和修改等。
* **crafted 表達式**: crafted 表達式是一種特殊的表達式，設計用於繞過安全檢查，執行任意系統命令。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://thehackernews.com/2026/02/critical-n8n-flaw-cve-2026-25049.html)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)


