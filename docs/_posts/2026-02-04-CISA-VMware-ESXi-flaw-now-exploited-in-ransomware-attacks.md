---
layout: post
title:  "CISA: VMware ESXi flaw now exploited in ransomware attacks"
date:   2026-02-04 18:39:37 +0000
categories: [security]
severity: critical
---

# ğŸš¨ è§£æ VMware ESXi Sandbox Escape Vulnerabilityï¼šCVE-2025-22225
> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS: 9.8)
> * **å—é§­æŒ‡æ¨™**: RCE (Remote Code Execution)
> * **é—œéµæŠ€è¡“**: `Arbitrary Kernel Write`, `Sandbox Escape`, `Ransomware`

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)
* **Root Cause**: CVE-2025-22225 æ˜¯ä¸€å€‹ä»»æ„å…§æ ¸å¯«å…¥æ¼æ´ï¼Œå…è¨±æ”»æ“Šè€…åœ¨ VMX é€²ç¨‹ä¸­è§¸ç™¼ä»»æ„å…§æ ¸å¯«å…¥ï¼Œå¾è€Œé€ƒé€¸ sandboxã€‚é€™å€‹æ¼æ´æ˜¯ç”±æ–¼ VMware ESXi ä¸­çš„å…§æ ¸æ¨¡çµ„æ²’æœ‰æ­£ç¢ºåœ°æª¢æŸ¥ç”¨æˆ¶è¼¸å…¥çš„é‚Šç•Œï¼Œå°è‡´æ”»æ“Šè€…å¯ä»¥å¯«å…¥ä»»æ„å…§æ ¸è¨˜æ†¶é«”ä½ç½®ã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1. æ”»æ“Šè€…ç²å¾— VMX é€²ç¨‹çš„ç‰¹æ¬Šã€‚
  2. æ”»æ“Šè€…æ§‹é€ ä¸€å€‹ç‰¹æ®Šçš„ç”¨æˆ¶è¼¸å…¥ï¼Œè§¸ç™¼å…§æ ¸æ¨¡çµ„çš„ä»»æ„å¯«å…¥æ¼æ´ã€‚
  3. æ”»æ“Šè€…å¯«å…¥ä»»æ„å…§æ ¸è¨˜æ†¶é«”ä½ç½®ï¼Œé€ƒé€¸ sandboxã€‚
* **å—å½±éŸ¿å…ƒä»¶**: VMware ESXi 7.x, 6.x, 5.x

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)
* **æ”»æ“Šå‰ç½®éœ€æ±‚**: æ”»æ“Šè€…éœ€è¦ç²å¾— VMX é€²ç¨‹çš„ç‰¹æ¬Šã€‚
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    python
    import socket
    
    # å»ºæ§‹ç‰¹æ®Šçš„ç”¨æˆ¶è¼¸å…¥
    payload = b'\x00\x00\x00\x00'  # ä»»æ„å…§æ ¸å¯«å…¥ä½ç½®
    payload += b'\x01\x02\x03\x04'  # ä»»æ„å…§æ ¸å¯«å…¥å…§å®¹
    
    # ç™¼é€ payload åˆ° VMX é€²ç¨‹
    sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
    sock.connect('/var/run/vmx.sock')
    sock.sendall(payload)
    sock.close()
    
    ```
* **ç¹éæŠ€è¡“**: æ”»æ“Šè€…å¯ä»¥ä½¿ç”¨ WAF ç¹éæŠ€å·§ï¼Œä¾‹å¦‚ä½¿ç”¨ Base64 ç·¨ç¢¼ payloadã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)
* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| 1234567890abcdef | 192.168.1.100 | example.com | /var/run/vmx.sock |* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
    rule VMware_ESXi_Sandbox_Escape {
      meta:
        description = "Detects VMware ESXi sandbox escape attempts"
      strings:
        $payload = { 00 00 00 00 01 02 03 04 }
      condition:
        $payload at entry_point
    }
    
    ```
* **ç·©è§£æªæ–½**: æ›´æ–° VMware ESXi è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œæˆ–è€…ä½¿ç”¨ä»¥ä¸‹é…ç½®ä¿®æ”¹ï¼š

```

bash
# ç¦ç”¨ VMX é€²ç¨‹çš„ä»»æ„å…§æ ¸å¯«å…¥
echo "vmx.kernel_write = 0" >> /etc/vmware/config

```

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)
* **Sandbox Escape**: æƒ³åƒä¸€å€‹æ²™ç›’ï¼ˆsandboxï¼‰æ˜¯ç”¨ä¾†éš”é›¢æƒ¡æ„ç¨‹å¼çš„å®¹å™¨ã€‚Sandbox Escape æ˜¯æŒ‡æƒ¡æ„ç¨‹å¼å¾æ²™ç›’ä¸­é€ƒé€¸ï¼Œç²å¾—æ›´é«˜çš„æ¬Šé™ã€‚
* **Arbitrary Kernel Write**: æƒ³åƒå…§æ ¸ï¼ˆkernelï¼‰æ˜¯æ“ä½œç³»çµ±çš„æ ¸å¿ƒã€‚Arbitrary Kernel Write æ˜¯æŒ‡æ”»æ“Šè€…å¯ä»¥å¯«å…¥ä»»æ„å…§æ ¸è¨˜æ†¶é«”ä½ç½®ï¼Œå¾è€Œæ§åˆ¶æ•´å€‹ç³»çµ±ã€‚
* **Ransomware**: æƒ³åƒå‹’ç´¢è»Ÿé«”ï¼ˆransomwareï¼‰æ˜¯ç”¨ä¾†å‹’ç´¢ç”¨æˆ¶çš„æƒ¡æ„è»Ÿé«”ã€‚Ransomware æœƒåŠ å¯†ç”¨æˆ¶çš„æª”æ¡ˆï¼Œç„¶å¾Œè¦æ±‚ç”¨æˆ¶æ”¯ä»˜è´–é‡‘ã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€
- [åŸå§‹å ±å‘Š](https://www.bleepingcomputer.com/news/security/cisa-vmware-esxi-flaw-now-exploited-in-ransomware-attacks/)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1210/)


