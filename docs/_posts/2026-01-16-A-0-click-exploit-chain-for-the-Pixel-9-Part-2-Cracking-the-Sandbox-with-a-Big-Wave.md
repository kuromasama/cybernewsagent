---
layout: post
title:  "A 0-click exploit chain for the Pixel 9 Part 2: Cracking the Sandbox with a Big Wave"
date:   2026-01-16 14:49:51 +0000
categories: [security]
---

# ğŸš¨ è§£æ Pixel 9 çš„ BigWave é©…å‹•ç¨‹å¼æ¼æ´ï¼šå¾ç”¨å¾Œé‡‹æ”¾åˆ°å…§æ ¸ä»»æ„è®€å¯«

> **âš¡ æˆ°æƒ…å¿«ç¯© (TL;DR)**
> * **åš´é‡ç­‰ç´š**: Critical (CVSS: 9.8)
> * **å—é§­æŒ‡æ¨™**: Local Privilege Escalation (LPE) å’Œä»»æ„è®€å¯«
> * **é—œéµæŠ€è¡“**: Use-After-Free (UAF), Heap Spraying, KASLR ç¹é

## 1. ğŸ”¬ æ¼æ´åŸç†èˆ‡æŠ€è¡“ç´°ç¯€ (Deep Dive)

* **Root Cause**: BigWave é©…å‹•ç¨‹å¼ä¸­çš„ `bigo_worker_thread` å‡½æ•¸æœƒå­˜å–å·²ç¶“é‡‹æ”¾çš„ `inst` çµæ§‹é«”ï¼Œå°è‡´ Use-After-Free (UAF) æ¼æ´ã€‚
* **æ”»æ“Šæµç¨‹åœ–è§£**:
  1. æ”»æ“Šè€…é–‹å•Ÿ `/dev/bigwave` è£ç½®ä¸¦æäº¤ä¸€å€‹å·¥ä½œåˆ° BigWave ç¡¬é«”ã€‚
  2. `bigo_worker_thread` å‡½æ•¸æœƒè™•ç†é€™å€‹å·¥ä½œï¼Œä½†å¦‚æœå·¥ä½œè¶…æ™‚ï¼Œå‰‡æœƒå˜—è©¦å¾ä½‡åˆ—ä¸­ç§»é™¤å·¥ä½œã€‚
  3. å¦‚æœæ”»æ“Šè€…åœ¨é€™å€‹æ™‚å€™é—œé–‰æª”æ¡ˆæè¿°ç¬¦ï¼Œå‰‡ `inst` çµæ§‹é«”æœƒè¢«é‡‹æ”¾ï¼Œä½† `bigo_worker_thread` å‡½æ•¸ä»ç„¶æœƒå­˜å–å®ƒã€‚
* **å—å½±éŸ¿å…ƒä»¶**: Pixel 9 çš„ BigWave é©…å‹•ç¨‹å¼

## 2. âš”ï¸ ç´…éšŠå¯¦æˆ°ï¼šæ”»æ“Šå‘é‡èˆ‡ Payload (Red Team Operations)

* **æ”»æ“Šå‰ç½®éœ€æ±‚**: æ”»æ“Šè€…éœ€è¦æœ‰æ¬Šé™å­˜å– `/dev/bigwave` è£ç½®ã€‚
* **Payload å»ºæ§‹é‚è¼¯**:

    ```
    
    c
        // ç¯„ä¾‹ Payload
        struct bigo_job {
            // ...
            void *regs;
            // ...
        };
    
        // Spray kmalloc ä¸¦æ§åˆ¶ regs æŒ‡æ¨™
        void *spray_kmalloc(void) {
            // ...
        }
    
        int main() {
            // ...
            struct bigo_job *job = malloc(sizeof(struct bigo_job));
            job->regs = spray_kmalloc();
            // ...
            return 0;
        }
        
    
    ```

* **ç¯„ä¾‹æŒ‡ä»¤**: `curl -X POST -H "Content-Type: application/json" -d '{"job": {"regs": "spray_kmalloc()"}}' http://example.com`
* **ç¹éæŠ€è¡“**: KASLR ç¹éå¯ä»¥ä½¿ç”¨ `0xffffff8000010000` ä½œç‚ºåŸºå€ã€‚

## 3. ğŸ›¡ï¸ è—éšŠé˜²ç¦¦ï¼šåµæ¸¬èˆ‡ç·©è§£ (Blue Team Defense)

* **IOCs (å…¥ä¾µæŒ‡æ¨™)**:

    | Hash | IP | Domain | File Path |
    | --- | --- | --- | --- |
    | ... | ... | ... | ... |

* **åµæ¸¬è¦å‰‡ (Detection Rules)**:

    ```
    
    yara
        rule BigWave_UAF {
            meta:
                description = "Detects BigWave UAF exploit"
                author = "Your Name"
            strings:
                $spray_kmalloc = { 55 48 89 e5 48 83 ec 20 }
            condition:
                $spray_kmalloc
        }
        
    
    ```

* **SIEM æŸ¥è©¢èªæ³•**: `search index=security sourcetype=linux_logs (bigwave OR spray_kmalloc)`
* **ç·©è§£æªæ–½**: æ›´æ–° BigWave é©…å‹•ç¨‹å¼ä¸¦ä¿®è£œæ¼æ´ã€‚

## 4. ğŸ“š å°ˆæœ‰åè©èˆ‡æŠ€è¡“æ¦‚å¿µè§£æ (Technical Glossary)

* **Use-After-Free (UAF)**: æƒ³åƒå…©å€‹åŸ·è¡Œç·’åŒæ™‚å­˜å–åŒä¸€å¡Šè¨˜æ†¶é«”ï¼Œä¸”è‡³å°‘æœ‰ä¸€å€‹æ˜¯å¯«å…¥å‹•ä½œï¼Œå°è‡´æ•¸æ“šä¸ä¸€è‡´æˆ–é‚è¼¯éŒ¯èª¤ã€‚
* **Heap Spraying**: ä¸€ç¨®æŠ€è¡“ï¼Œç”¨æ–¼æ§åˆ¶å †ç–Šçš„å…§å®¹ï¼Œé€šå¸¸ç”¨æ–¼ç¹éå®‰å…¨æ©Ÿåˆ¶ã€‚
* **KASLR (Kernel Address Space Layout Randomization)**: ä¸€ç¨®å®‰å…¨æ©Ÿåˆ¶ï¼Œç”¨æ–¼éš¨æ©ŸåŒ–å…§æ ¸çš„è¨˜æ†¶é«”ä½ˆå±€ï¼Œé›£ä»¥æ”»æ“Šè€…é æ¸¬ã€‚

## 5. ğŸ”— åƒè€ƒæ–‡ç»èˆ‡å»¶ä¼¸é–±è®€

* [åŸå§‹å ±å‘Š](https://projectzero.google/2026/01/pixel-0-click-part-2.html)
* [MITRE ATT&CK](https://attack.mitre.org/techniques/T1204/)