---
layout: post
title:  "Claude桌面擴充套件遭指存在零點擊RCE漏洞，逾1萬用戶恐曝險"
date:   2026-02-11 12:54:45 +0000
categories: [security]
severity: critical
---

# 🚨 解析 Claude 桌面擴充套件的零點擊遠端程式碼執行漏洞

> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: Critical (CVSS 分數 10.0)
> * **受駭指標**: RCE (Remote Code Execution)
> * **關鍵技術**: 工作流程與信任邊界設計、桌面擴充套件權限模型

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: Claude 桌面擴充套件的工作流程與信任邊界設計存在缺陷，導致攻擊者可以透過單一 Google Calendar 行事曆事件植入特定內容，觸發本機任意程式碼執行。
* **攻擊流程圖解**:
  1. 攻擊者創建一個包含惡意內容的 Google Calendar 行事曆事件。
  2. 受害者使用 Claude 桌面擴充套件讀取最新行程並協助處理相關事項。
  3. Claude 桌面擴充套件自行判斷需呼叫的連接器與工具，並把不同來源的資料串接起來完成任務。
  4. 攻擊者可以透過這個過程植入惡意程式碼，導致本機任意程式碼執行。
* **受影響元件**: Claude 桌面擴充套件、Google Calendar 行事曆事件

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 攻擊者需要知道受害者的 Google Calendar 行事曆事件 ID 和 Claude 桌面擴充套件的版本號。
* **Payload 建構邏輯**:

    ```
    
    python
    import requests
    
    # 定義惡意內容
    malicious_content = "echo 'Hello, World!' > /tmp/hello.txt"
    
    # 定義 Google Calendar 行事曆事件 ID
    event_id = "1234567890"
    
    # 定義 Claude 桌面擴充套件的版本號
    version = "1.0.0"
    
    # 建構 Payload
    payload = {
        "event_id": event_id,
        "version": version,
        "content": malicious_content
    }
    
    # 發送 Payload
    response = requests.post("https://example.com/claude-desktop-extension", json=payload)
    
    # 檢查是否成功
    if response.status_code == 200:
        print("Payload sent successfully!")
    else:
        print("Failed to send payload.")
    
    ```
* **繞過技術**: 攻擊者可以使用 WAF 繞過技巧，例如使用 Base64 編碼惡意內容。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| 1234567890 | 192.168.1.100 | example.com | /tmp/hello.txt |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule Claude_Desktop_Extension {
        meta:
            description = "Detects Claude Desktop Extension exploitation"
            author = "Blue Team"
        strings:
            $a = "echo 'Hello, World!' > /tmp/hello.txt"
        condition:
            $a
    }
    
    ```
* **緩解措施**: 除了更新 Claude 桌面擴充套件之外，還可以設定 WAF 规則以阻止惡意內容。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **工作流程與信任邊界設計**: 想像兩個系統之間的溝通過程。技術上是指定義系統之間的溝通規則和邊界，以確保安全性和可靠性。
* **桌面擴充套件權限模型**: 想像一個桌面應用程式的權限設定。技術上是指定義桌面應用程式的權限和存取控制，以確保安全性和可靠性。
* **RCE (Remote Code Execution)**: 想像一個遠端系統可以執行任意程式碼。技術上是指攻擊者可以透過網路遠端執行任意程式碼，導致安全性漏洞。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://www.ithome.com.tw/news/173905)
- [MITRE ATT&CK 編號](https://attack.mitre.org/techniques/T1204/)


