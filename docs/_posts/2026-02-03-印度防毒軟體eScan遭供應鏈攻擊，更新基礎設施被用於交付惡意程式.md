---
layout: post
title:  "印度防毒軟體eScan遭供應鏈攻擊，更新基礎設施被用於交付惡意程式"
date:   2026-02-03 12:43:53 +0000
categories: [security]
severity: high
---

# 🔥 解析 eScan 防毒軟體更新機制漏洞：基礎設施層級的攻防技術
> **⚡ 戰情快篩 (TL;DR)**
> * **嚴重等級**: High (CVSS 分數：8.5)
> * **受駭指標**: RCE (Remote Code Execution)
> * **關鍵技術**: `更新機制漏洞`, `HOSTS 檔案修改`, `自動更新機制繞過`

## 1. 🔬 漏洞原理與技術細節 (Deep Dive)
* **Root Cause**: eScan 防毒軟體的更新機制存在漏洞，允許攻擊者取得區域更新伺服器的存取權，並透過原本用來交付病毒碼與程式更新的管道，向部分用戶發送惡意檔案。這個漏洞是基於基礎設施層級的，而非 eScan 產品程式碼的缺陷或漏洞。
* **攻擊流程圖解**: 
    1. 攻擊者取得區域更新伺服器的存取權。
    2. 攻擊者透過更新機制向部分用戶發送惡意檔案 (Reload.exe)。
    3. 惡意檔案嘗試修改 HOSTS 檔案，阻斷後續更新。
* **受影響元件**: eScan 防毒軟體的更新機制，尤其是區域更新伺服器。

## 2. ⚔️ 紅隊實戰：攻擊向量與 Payload (Red Team Operations)
* **攻擊前置需求**: 攻擊者需要取得區域更新伺服器的存取權。
* **Payload 建構邏輯**:

    ```
    
    python
    # 範例 Payload 結構
    payload = {
        'file_name': 'Reload.exe',
        'file_content': '...惡意程式碼...',
        'hosts_file_content': '...修改後的 HOSTS 檔案內容...'
    }
    
    ```
    *範例指令*:

```

bash
curl -X POST \
  http://example.com/update \
  -H 'Content-Type: application/json' \
  -d '{"file_name": "Reload.exe", "file_content": "...惡意程式碼..."}'

```
* **繞過技術**: 攻擊者可以透過修改 HOSTS 檔案，阻斷後續更新，增加修復難度。

## 3. 🛡️ 藍隊防禦：偵測與緩解 (Blue Team Defense)
* **IOCs (入侵指標)**:

| Hash | IP | Domain | File Path |
| --- | --- | --- | --- |
| ... | ... | ... | ... |* **偵測規則 (Detection Rules)**:

    ```
    
    yara
    rule eScan_Update_Malware {
        meta:
            description = "eScan 更新機制漏洞惡意檔案"
            author = "..."
        strings:
            $a = "Reload.exe"
        condition:
            $a
    }
    
    ```
    或者是具體的 SIEM 查詢語法 (Splunk/Elastic)：

```

sql
index=security sourcetype=update_log file_name="Reload.exe"

```
* **緩解措施**: 除了更新修補之外，還可以透過修改 HOSTS 檔案，恢復正常的更新機制。

## 4. 📚 專有名詞與技術概念解析 (Technical Glossary)
* **更新機制 (Update Mechanism)**: 想像軟體的更新過程，如同一個自動化的管道。技術上是指軟體的更新過程，包括下載、安裝和驗證更新檔案。
* **HOSTS 檔案 (HOSTS File)**: 想像一個電話簿，記錄著網域名稱和 IP 地址的對應關係。技術上是指一個檔案，記錄著網域名稱和 IP 地址的對應關係，用於 DNS 解析。
* **自動更新機制 (Automatic Update Mechanism)**: 想像一個自動化的更新過程，如同一個背景執行的程式。技術上是指軟體的自動更新過程，包括下載、安裝和驗證更新檔案。

## 5. 🔗 參考文獻與延伸閱讀
- [原始報告](https://www.ithome.com.tw/news/173736)
- [MITRE ATT&CK 編號](https://attack.mitre.org/techniques/T1190/)


